–•–æ—Ä–æ—à–æ, –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º "–°–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.md" –∏ —Å–æ—Å—Ç–∞–≤–∏–º –ø–ª–∞–Ω –ø–∞—Ä—Å–µ—Ä–∞.

**1. –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤ –∏–∑ "–°–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.md"**

–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–≤ —Ñ–∞–π–ª `üöÄ –•–∞–∫–∞—Ç–æ–Ω - ChatHRD/–°–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.md`, –º—ã –≤–∏–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∏ –∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

* –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏`.xlsx`
* –ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞`.docx`
* –û–ø–∏—Å–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ –ò–Ω–∂–µ–Ω–µ—Ä –¥–∞–Ω–Ω—ã—Ö`.pdf`
* –ü–æ–ª–æ–∂–µ–Ω–∏–µ –æ –ø–æ–¥–±–æ—Ä–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞`.docx`
* –ü—Ä–æ—Ç–æ–∫–æ–ª –≤—Å—Ç—Ä–µ—á–∏ –ø–æ –≤–∞–∫–∞–Ω—Å–∏–∏`.docx`
* –†–µ–∑—é–º–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –ò–≤–∞–Ω–æ–≤–∞ –ò–ò`.docx`
* –†–µ–∑—é–º–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –ü–µ—Ç—Ä–æ–≤–∞ –ê–ê`.pdf`
* –†–µ–≥–ª–∞–º–µ–Ω—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏`.pdf`
* –°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –°–∏–¥–æ—Ä–æ–≤–∞ –ü–°`.docx`
* –°–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é`.xlsx`
* –°—Ç–∞—Ç—å—è –æ–± –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤`.pdf`
* –®–∞–±–ª–æ–Ω –ø–∏—Å—å–º–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç—É`.docx`
* –ü–æ–ª–∏—Ç–∏–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏`.docx`

**–ü–µ—Ä–µ—á–µ–Ω—å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤:**

1.  `.pdf` (Portable Document Format)
2.  `.docx` (Microsoft Word Open XML Document)
3.  `.xlsx` (Microsoft Excel Open XML Spreadsheet)

**2. –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä—Å–µ—Ä–∞ –Ω–∞ Python**

–¶–µ–ª—å: –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∏ —Ç–∞–±–ª–∏—Ü—ã –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ.

**–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:**

1.  **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ —Ñ–∞–π–ª–∞:** –ü–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ–∞–π–ª–∞ (`.pdf`, `.docx`, `.xlsx`).
2.  **–í—ã–±–æ—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:** –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Python.
3.  **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞:** –ü–æ–ª—É—á–∏—Ç—å –≤–µ—Å—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞.
4.  **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:** –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏ –∏–∑–≤–ª–µ—á—å —Ç–∞–±–ª–∏—Ü—ã. –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤, Markdown –∏–ª–∏ pandas DataFrame).
5.  **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞:** –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–∞–º–∏ 'text' –∏ 'tables'.

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python:**

* **–î–ª—è `.pdf`:**
    * `PyMuPDF` (`fitz`): –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –∏–º–µ–µ—Ç –±–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–∞–±–ª–∏—Ü. –°—á–∏—Ç–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö –∏ –Ω–∞–¥–µ–∂–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è PDF.
    * `camelot-py` (–∏–ª–∏ `tabula-py`): –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏–∑ PDF. Camelot —á–∞—Å—Ç–æ –¥–∞–µ—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ "—á–∏—Å—Ç—ã—Ö" PDF, Tabula –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–∞ –≤ –¥—Ä—É–≥–∏—Ö —Å–ª—É—á–∞—è—Ö. –ü–æ—Ç—Ä–µ–±—É—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Ghostscript –¥–ª—è Camelot, Java –¥–ª—è Tabula). *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –º–æ–∂–µ—Ç —É—Å–ª–æ–∂–Ω–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.*
    * *–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞/–î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ:* –ï—Å–ª–∏ PDF —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è OCR (Optical Character Recognition) —Å –ø–æ–º–æ—â—å—é `pytesseract` (—Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ Tesseract OCR).
* **–î–ª—è `.docx`:**
    * `python-docx`: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `.docx`. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –∏–∑–≤–ª–µ–∫–∞—Ç—å –ø–∞—Ä–∞–≥—Ä–∞—Ñ—ã (—Ç–µ–∫—Å—Ç) –∏ —Ç–∞–±–ª–∏—Ü—ã.
* **–î–ª—è `.xlsx`:**
    * `pandas`: –°–∞–º—ã–π —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± —á–∏—Ç–∞—Ç—å `.xlsx` —Ñ–∞–π–ª—ã. –ß–∏—Ç–∞–µ—Ç –ª–∏—Å—Ç—ã Excel –Ω–∞–ø—Ä—è–º—É—é –≤ DataFrame, —á—Ç–æ —É–∂–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü—ã. –¢–µ–∫—Å—Ç –∏–∑ —è—á–µ–µ–∫ –ª–µ–≥–∫–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è.
    * `openpyxl`: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `pandas` –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –¥–ª—è `.xlsx`, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∏ –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –±–æ–ª–µ–µ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è, –µ—Å–ª–∏ `pandas` –Ω–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∫–∞–∫–∏–º-—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

**–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

1.  **–°–æ–∑–¥–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–∞—Ä—Å–µ—Ä–∞:**
    ```python
    import os
    import pandas as pd
    import docx # python-docx
    import fitz # PyMuPDF
    # import camelot # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü PDF
    # import io # –ú–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏

    def parse_document(file_path):
        """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —Ñ–∞–π–ª–∞ (.pdf, .docx, .xlsx).

        Args:
            file_path (str): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É.

        Returns:
            dict: –°–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–∞–º–∏ 'text' (str) –∏ 'tables' (list),
                  –≥–¥–µ tables - —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ñ–æ—Ä–º–∞—Ç–µ list of lists –∏–ª–∏ Markdown).
            None: –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∏–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞.
        """
        _, extension = os.path.splitext(file_path.lower())
        result = {"text": "", "tables": []}

        try:
            if extension == ".pdf":
                result = _parse_pdf(file_path)
            elif extension == ".docx":
                result = _parse_docx(file_path)
            elif extension == ".xlsx":
                 result = _parse_xlsx(file_path)
            else:
                print(f"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞: {extension}")
                return None # –ò–ª–∏ –≤–µ—Ä–Ω—É—Ç—å –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
            result['text'] = _clean_text(result.get('text', ''))

            return result

        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞ {file_path}: {e}")
            return None # –ò–ª–∏ –≤–µ—Ä–Ω—É—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ

    def _clean_text(text):
         # –£–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã, –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –∏ —Ç.–¥.
         text = ' '.join(text.split())
         return text

    # ... —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π _parse_pdf, _parse_docx, _parse_xlsx –Ω–∏–∂–µ ...
    ```

2.  **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –¥–ª—è `.pdf` (`_parse_pdf`):**
    ```python
    def _parse_pdf(file_path):
        text_content = ""
        tables_content = []
        try:
            doc = fitz.open(file_path)
            for page_num in range(len(doc)):
                page = doc.load_page(page_num)
                text_content += page.get_text("text") + "\n"

                # --- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤) ---

                # 1. –ü—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥ —Å PyMuPDF (–º–æ–∂–µ—Ç –Ω–µ –Ω–∞–π—Ç–∏ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã)
                tabs = page.find_tables()
                if tabs:
                    print(f"–ù–∞–π–¥–µ–Ω—ã —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —Å—Ç—Ä. {page_num + 1} —Å –ø–æ–º–æ—â—å—é PyMuPDF find_tables()")
                    for tab in tabs:
                        # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É –≤ Markdown –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã
                        tables_content.append(tab.to_markdown(clean=True))
                        # –ò–ª–∏ –≤ list of lists: tables_content.append(tab.extract())

                # 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Camelot (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω—É–∂–µ–Ω)
                # try:
                #     # stream=True –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å –≤–∏–¥–∏–º—ã–º–∏ –ª–∏–Ω–∏—è–º–∏
                #     # flavor='lattice' –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å –ª–∏–Ω–∏—è–º–∏, 'stream' –¥–ª—è –±–µ–∑–ª–∏–Ω–µ–π–Ω—ã—Ö
                #     camelot_tables = camelot.read_pdf(file_path, pages=str(page_num + 1), flavor='lattice', suppress_stdout=True)
                #     if camelot_tables.n > 0:
                #          print(f"–ù–∞–π–¥–µ–Ω—ã —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —Å—Ç—Ä. {page_num + 1} —Å –ø–æ–º–æ—â—å—é Camelot")
                #          for table in camelot_tables:
                #              # table.df - —ç—Ç–æ pandas DataFrame
                #              tables_content.append(table.df.to_markdown(index=False))
                # except ImportError:
                #      pass # Camelot –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                # except Exception as e_camelot:
                #      print(f"–û—à–∏–±–∫–∞ Camelot –Ω–∞ —Å—Ç—Ä {page_num + 1}: {e_camelot}")


            doc.close()
        except Exception as e:
             print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ PDF {file_path}: {e}")
             # –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Ç–æ, —á—Ç–æ —É—Å–ø–µ–ª–∏ –∏–∑–≤–ª–µ—á—å, –∏–ª–∏ –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
             return {"text": text_content, "tables": tables_content}

        return {"text": text_content, "tables": tables_content}
    ```
    *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏–∑ PDF ‚Äî —Å–ª–æ–∂–Ω–∞—è –∑–∞–¥–∞—á–∞. `PyMuPDF.find_tables()` —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤. `camelot` –±–æ–ª–µ–µ –º–æ—â–Ω—ã–π, –Ω–æ –∏–º–µ–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥—Ö–æ–¥—ã –∏–ª–∏ –¥–∞–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OCR –¥–ª—è PDF —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.*

3.  **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –¥–ª—è `.docx` (`_parse_docx`):**
    ```python
    def _parse_docx(file_path):
        try:
            document = docx.Document(file_path)
            text_content = "\n".join([para.text for para in document.paragraphs])
            tables_content = []

            for table in document.tables:
                table_data = []
                for row in table.rows:
                    row_data = [cell.text for cell in row.cells]
                    table_data.append(row_data)
                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ Markdown –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è (–º–æ–∂–Ω–æ –∏ –≤ list of lists –æ—Å—Ç–∞–≤–∏—Ç—å)
                # –ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è, –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π `tabulate`
                try:
                     import tabulate
                     tables_content.append(tabulate.tabulate(table_data, headers="firstrow", tablefmt="pipe"))
                except ImportError:
                     # –ï—Å–ª–∏ tabulate –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –¥–µ–ª–∞–µ–º –ø—Ä–æ—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
                     md_table = "| " + " | ".join(map(str, table_data[0])) + " |\n"
                     md_table += "|-" + "-|".join(['-' * len(str(h)) for h in table_data[0]]) + "-|\n"
                     for row_d in table_data[1:]:
                          md_table += "| " + " | ".join(map(str, row_d)) + " |\n"
                     tables_content.append(md_table)


        except Exception as e:
             print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ DOCX {file_path}: {e}")
             return {"text": "", "tables": []}

        return {"text": text_content, "tables": tables_content}
    ```

4.  **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –¥–ª—è `.xlsx` (`_parse_xlsx`):**
    ```python
    def _parse_xlsx(file_path):
        text_content = "" # –í Excel —Ç–µ–∫—Å—Ç –æ–±—ã—á–Ω–æ –≤–Ω—É—Ç—Ä–∏ —è—á–µ–µ–∫ —Ç–∞–±–ª–∏—Ü
        tables_content = []
        try:
            # –ß–∏—Ç–∞–µ–º –≤—Å–µ –ª–∏—Å—Ç—ã
            xls = pd.ExcelFile(file_path)
            for sheet_name in xls.sheet_names:
                df = pd.read_excel(xls, sheet_name=sheet_name)
                # –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Å—Ç–æ—è—â–∏–µ –∏–∑ NaN
                df.dropna(axis=0, how='all', inplace=True)
                df.dropna(axis=1, how='all', inplace=True)

                if not df.empty:
                     # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º DataFrame –≤ Markdown
                     tables_content.append(df.to_markdown(index=False))
                     # –°–æ–±–∏—Ä–∞–µ–º —Ç–µ–∫—Å—Ç –∏–∑ –≤—Å–µ—Ö —è—á–µ–µ–∫ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ)
                     for col in df.columns:
                         text_content += ' '.join(df[col].astype(str).tolist()) + '\n'

        except Exception as e:
             print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ XLSX {file_path}: {e}")
             return {"text": text_content, "tables": tables_content} # –í–µ—Ä–Ω—É—Ç—å —á—Ç–æ —É—Å–ø–µ–ª–∏

        return {"text": text_content.strip(), "tables": tables_content}

    ```

5.  **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
    * –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞.
    * –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞.
    * –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ).
    * –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ (–ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, —Ñ–∞–π–ª—ã —Å –ø–∞—Ä–æ–ª—è–º–∏ –∏ —Ç.–¥.).

**–î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:**

* **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
* **OCR –¥–ª—è PDF:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `pytesseract` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
* **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü:** –ü—Ä–∏–≤–µ—Å—Ç–∏ –≤—Å–µ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `List[List[str]]` –∏–ª–∏ pandas DataFrame) –ø–µ—Ä–µ–¥ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π (–≤ Markdown –∏–ª–∏ –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç).
* **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** –ï—Å–ª–∏ —Ñ–∞–π–ª–æ–≤ –º–Ω–æ–≥–æ, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `asyncio` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
* **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞.
* **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `camelot`) –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª.

–≠—Ç–æ—Ç –ø–ª–∞–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ—Å–Ω–æ–≤—É –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤. –ù–∞—á–Ω–∏—Ç–µ —Å –±–∞–∑–æ–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ —É–ª—É—á—à–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.